import pandas as pd
import joblib

# Load the trained Isolation Forest model
model = joblib.load("../models/isolation_forest.pkl")

# Example input data (this could be replaced with real-time data in a real application)
# Here we use some sample data points for demonstration
new_data = pd.DataFrame({
    "network_traffic": [0.5, 1.7, 0.4, 3.0, 0.6],
    "health_metric": [98, 102, 99, 95, 110]
})

# Predict anomalies (returns -1 for anomaly, 1 for normal)
predictions = model.predict(new_data)

# Print results
new_data["prediction"] = predictions
new_data["prediction"] = new_data["prediction"].apply(lambda x: "Anomaly" if x == -1 else "Normal")

print(new_data)
