import pandas as pd
import numpy as np
from sklearn.ensemble import IsolationForest
import joblib

# Load the synthetic IoMT data
data = pd.read_csv("../data/iomt_device_data.csv")

# Define features for the model (e.g., network traffic and health metrics)
features = data[["network_traffic", "health_metric"]]

# Initialize the Isolation Forest model
model = IsolationForest(n_estimators=100, contamination=0.1, random_state=42)

# Train the model on the dataset
model.fit(features)

# Save the trained model to a file
model_filename = "../models/isolation_forest.pkl"
joblib.dump(model, model_filename)

print(f"Model trained and saved to {model_filename}")
