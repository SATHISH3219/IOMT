import numpy as np
import pandas as pd
from datetime import datetime, timedelta

# Function to generate synthetic IoMT device data
def generate_device_data(num_samples=1000):
    # Generate a date range for the timestamps
    timestamps = [datetime.now() - timedelta(hours=i) for i in range(num_samples)]
    timestamps.reverse()

    # Generate synthetic network traffic data (normal and anomalous)
    network_traffic = np.random.normal(0.5, 0.1, num_samples)  # Normal traffic
    # Introduce some spikes to simulate potential anomalies
    anomaly_indices = np.random.choice(num_samples, size=int(0.1 * num_samples), replace=False)
    network_traffic[anomaly_indices] = np.random.uniform(1.5, 3.0, size=len(anomaly_indices))

    # Generate synthetic health data (e.g., glucose levels or heart rate)
    health_metrics = np.random.normal(100, 10, num_samples)

    # Create a DataFrame to hold the data
    data = pd.DataFrame({
        "timestamp": timestamps,
        "network_traffic": network_traffic,
        "health_metric": health_metrics,
        "anomaly": [1 if i in anomaly_indices else 0 for i in range(num_samples)]  # Label anomalies
    })

    # Save the generated data to a CSV file
    data.to_csv("../data/iomt_device_data.csv", index=False)
    print("Synthetic IoMT device data generated and saved to 'data/iomt_device_data.csv'")

# Run data generation
generate_device_data()
